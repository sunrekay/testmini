<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <script>
        // Функция для очистки URL от параметров Telegram Mini App
        function cleanTelegramParams(url) {
            const telegramParams = [
                'tgWebAppPlatform', 'tgWebAppVersion', 'tgWebAppThemeParams',
                'tgWebAppData', 'tgWebAppStartParam', 'tgWebAppBotInline',
                'tgShareScoreUrl', 'tgWebAppShowSettings', 'tgWebAppFeedback'
            ];
            
            try {
                const urlObj = new URL(url);
                
                // Удаляем параметры Telegram
                telegramParams.forEach(param => {
                    urlObj.searchParams.delete(param);
                });
                
                // Также удаляем любые параметры, начинающиеся с 'tg'
                const allParams = Array.from(urlObj.searchParams.keys());
                allParams.forEach(param => {
                    if (param.toLowerCase().startsWith('tg')) {
                        urlObj.searchParams.delete(param);
                    }
                });
                
                return urlObj.toString();
            } catch (error) {
                console.error('Error cleaning URL:', error);
                return url;
            }
        }
        
        // Функция перенаправления
        function redirectToTarget() {
            // Целевой сайт для перенаправления
            const targetUrl = 'https://rutube.ru';
            
            // Получаем текущий URL
            const currentUrl = window.location.href;
            
            // Очищаем текущий URL от параметров Telegram
            const cleanedUrl = cleanTelegramParams(currentUrl);
            
            // Извлекаем параметры из очищенного URL (кроме Telegram параметров)
            const cleanedUrlObj = new URL(cleanedUrl);
            const params = new URLSearchParams(cleanedUrlObj.search);
            
            // Создаем финальный URL для перенаправления
            const finalUrl = new URL(targetUrl);
            
            // Добавляем все очищенные параметры к целевому URL
            params.forEach((value, key) => {
                finalUrl.searchParams.append(key, value);
            });
            
            // Добавляем хэш, если он есть
            if (cleanedUrlObj.hash) {
                finalUrl.hash = cleanedUrlObj.hash;
            }
            
            // Перенаправляем
            window.location.href = finalUrl.toString();
        }
        
        // Выполняем перенаправление при загрузке страницы
        window.onload = redirectToTarget;
    </script>
</head>
<body>
    <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
        <h1>Redirecting...</h1>
        <p>Please wait while we redirect you to the target website.</p>
        <p>If you are not redirected automatically, <a href="#" onclick="redirectToTarget()">click here</a>.</p>
    </div>
</body>
</html>
